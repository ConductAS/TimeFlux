<h1>Project: <%= @project.name %></h1>

<h3>
  Customer: <%= link_to @project.customer.name, customer_url(:id => @project.customer.id) %>
</h3>

<% form_for(Activity.new) do |f| %>
  <%= f.error_messages %>
  <%= f.text_field :name %>
  <%= hidden_field_tag "activity[project_id]", @project.id %>
  <%= f.submit 'Add Activity' %>
<% end %>

<hr/>

<h4>Current Activities</h4>
<ul>
  <% if @project.activities.count > 0 %>
    <% @project.activities.each do |activity|  %>
      <li>
        <%= link_to activity.name, edit_activity_url(:id => activity.id) %>
        <%= link_to image_tag("delete.png", :title => "Delete"), activity_path(activity), :method => :delete %>
      </li>
    <% end %>
  <% else %>
    <li>No activities</li>
  <% end %>
</ul>

<hr/>
<% templates = Activity.templates.map{|a|a.name} - @project.activities.map{|a|a.name} %>
<% if templates.size > 0 %>
  <div>
    <% form_tag :controller => 'activities', :action => 'create' do %>
      <%= select_tag "activity[name]", options_for_select( templates ), :multiple => true %>

      <%= hidden_field_tag "activity[project_id]", @project.id %>
      <%= hidden_field_tag "activity[default_activity]", 0 %>
      <%= hidden_field_tag "activity[shared]", 0 %>
      <%= hidden_field_tag "activity[description]", "Autogenerated activity" %>
      <%= hidden_field_tag "activity[active]", 1 %>
    <br/>
      <%= submit_tag "Add Template Activity" %>
    <% end %>
  </div>
<% end %>

<br/><br/>

<%= link_to 'Back', projects_path %>
